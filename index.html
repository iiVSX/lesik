<!DOCTYPE html>

<html>

<head>
  <title> test UI </title>
  <script src="http://code.jquery.com/jquery-3.5.1.min.js"></script>
  <style>
    body {
      text-align: center;
    }

    textarea {
      width: 60%;
      height: 200px;
    }

    table {
      border: 1px solid;
      margin-left: auto;
      margin-right: auto;
    }

    th,
    td {
      border: 1px solid;
    }
  </style>
</head>

<body>
  <h2>레시피 입력</h2>
  <form id="insert-recipe" class="ajax-form" action="/recipe" type="POST">
    <textarea id="recipe-box" name="recipe"></textarea>
    <br>
    <input type="submit" value="디지털 레시피 생성">
  </form>
  <div id="info"></div>
  <table>
    <colgroup>
      <col span=5 width="200">
    </colgroup>
    <thead>
      <tr>
        <th>설비</th>
        <th>도구</th>
        <th>재료</th>
        <th>첨가물</th>
        <th>동작</th>
      </tr>
    </thead>
    <tbody id="memDiv">
    </tbody>
  </table>

  <script>
    $(document).on('submit', 'form.ajax-form', function() {
	  var $this = $(this);

      $.post($this.attr('action'), $this.serialize())
          .done(function(data) {
              var sequence_list = JSON.parse(data);
              for (var i=0; i<sequence_list.length; i++) {
                var sequence = sequence_list[i];
                var insertTr = "";
                insertTr += "<tr>";
                insertTr += "<td>" + "" + "</td>";
                insertTr += "<td>" + sequence['tool'].join(",") + "</td>";
                insertTr += "<td>";
                for(var j=0; j<sequence['ingre'].length; j++){
                  insertTr += sequence['ingre'][j];
                  if(sequence['volume'].length > j){
                    insertTr += "(" + sequence['volume'][j] + ")";
                  }
                }
                insertTr += "</td>";
                insertTr += "<td>" + sequence['seasoning'].join(",") + "</td>";
                insertTr += "<td>" + sequence['act'] + "</td>";
                insertTr += "</tr>";

                $("#memDiv").append(insertTr);
                $("#recipe-box").text("");
              }
          })
          .fail(function(xhr, status, error) {
              alert(xhr.responseText);
          });

      return false;
  });
  </script>
</body>
</html>
